<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: Object</title>

	<link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link"><a href="Object.html">Object</a></p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-i-_in_root_dir">#_in_root_dir</a></li>
					
					<li><a href="#method-i-app">#app</a></li>
					
					<li><a href="#method-i-app">#app</a></li>
					
					<li><a href="#method-i-app">#app</a></li>
					
					<li><a href="#method-i-app">#app</a></li>
					
					<li><a href="#method-i-app">#app</a></li>
					
					<li><a href="#method-i-context_for_cramp_app">#context_for_cramp_app</a></li>
					
					<li><a href="#method-i-for_at_most">#for_at_most</a></li>
					
					<li><a href="#method-i-get">#get</a></li>
					
					<li><a href="#method-i-get">#get</a></li>
					
					<li><a href="#method-i-get_body">#get_body</a></li>
					
					<li><a href="#method-i-get_body_chunks">#get_body_chunks</a></li>
					
					<li><a href="#method-i-match_chunk">#match_chunk</a></li>
					
					<li><a href="#method-i-match_data">#match_data</a></li>
					
					<li><a href="#method-i-parse_response">#parse_response</a></li>
					
					<li><a href="#method-i-post">#post</a></li>
					
					<li><a href="#method-i-post">#post</a></li>
					
					<li><a href="#method-i-start_thin">#start_thin</a></li>
					
					<li><a href="#method-i-stop">#stop</a></li>
					
					<li><a href="#method-i-stop_thin">#stop_thin</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="./Gemfile.html">Gemfile</a></li>
				
					<li class="file"><a href="./commit.html">commit</a></li>
				
					<li class="file"><a href="./notes_txt.html">notes.txt</a></li>
				
					<li class="file"><a href="./run_specs.html">run_specs</a></li>
				
					<li class="file"><a href="./start.html">start</a></li>
				
					<li class="file"><a href="./stop.html">stop</a></li>
				
					<li class="file"><a href="./todo_txt.html">todo.txt</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./Horus.html">Horus</a></li>
				
					<li><a href="./Horus/Application.html">Horus::Application</a></li>
				
					<li><a href="./AddTileAction.html">AddTileAction</a></li>
				
					<li><a href="./Cramp.html">Cramp</a></li>
				
					<li><a href="./Game.html">Game</a></li>
				
					<li><a href="./GameEventRenderer.html">GameEventRenderer</a></li>
				
					<li><a href="./GameEventsAction.html">GameEventsAction</a></li>
				
					<li><a href="./GamePageAction.html">GamePageAction</a></li>
				
					<li><a href="./HelloWorld.html">HelloWorld</a></li>
				
					<li><a href="./HomePageAction.html">HomePageAction</a></li>
				
					<li><a href="./NewGameAction.html">NewGameAction</a></li>
				
					<li><a href="./Object.html">Object</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">Object</h1>

		<div id="description">
			
		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="-in-root-dir-method" class="method-detail ">
				<a name="method-i-_in_root_dir"></a>

				<div class="method-heading">
				
					<span class="method-name">_in_root_dir</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="-in-root-dir-source">
<pre>
    <span class="ruby-comment cmt"># File features/support/thin_support.rb, line 38</span>
38: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">_in_root_dir</span>
39:   <span class="ruby-identifier">old_dir</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>
40:   <span class="ruby-identifier">root_dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>), <span class="ruby-value str">&quot;../..&quot;</span>)
41:   <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">root_dir</span>)
42:   <span class="ruby-keyword kw">begin</span>
43:     <span class="ruby-keyword kw">yield</span>
44:   <span class="ruby-keyword kw">ensure</span>
45:     <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">old_dir</span>)
46:   <span class="ruby-keyword kw">end</span>
47: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="app-method" class="method-detail ">
				<a name="method-i-app"></a>

				<div class="method-heading">
				
					<span class="method-name">app</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="app-source">
<pre>
   <span class="ruby-comment cmt"># File spec/actions/frontend/game_page_action_spec.rb, line 7</span>
7:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">app</span>
8:       <span class="ruby-constant">Horus</span><span class="ruby-operator">::</span><span class="ruby-constant">Application</span>.<span class="ruby-identifier">routes</span>
9:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="app-method" class="method-detail ">
				<a name="method-i-app"></a>

				<div class="method-heading">
				
					<span class="method-name">app</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="app-source">
<pre>
   <span class="ruby-comment cmt"># File spec/actions/events/game_events_action_spec.rb, line 7</span>
7:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">app</span>
8:       <span class="ruby-constant">Horus</span><span class="ruby-operator">::</span><span class="ruby-constant">Application</span>.<span class="ruby-identifier">routes</span>
9:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="app-method" class="method-detail ">
				<a name="method-i-app"></a>

				<div class="method-heading">
				
					<span class="method-name">app</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="app-source">
<pre>
   <span class="ruby-comment cmt"># File spec/actions/api/add_tile_action_spec.rb, line 7</span>
7:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">app</span>
8:       <span class="ruby-constant">Horus</span><span class="ruby-operator">::</span><span class="ruby-constant">Application</span>.<span class="ruby-identifier">routes</span>
9:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="app-method" class="method-detail ">
				<a name="method-i-app"></a>

				<div class="method-heading">
				
					<span class="method-name">app</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="app-source">
<pre>
   <span class="ruby-comment cmt"># File spec/actions/api/new_game_action_spec.rb, line 7</span>
7:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">app</span>
8:       <span class="ruby-constant">Horus</span><span class="ruby-operator">::</span><span class="ruby-constant">Application</span>.<span class="ruby-identifier">routes</span>
9:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="app-method" class="method-detail ">
				<a name="method-i-app"></a>

				<div class="method-heading">
				
					<span class="method-name">app</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="app-source">
<pre>
    <span class="ruby-comment cmt"># File spec/actions/frontend/home_page_action_spec.rb, line 8</span>
 8:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">app</span>
 9:       <span class="ruby-constant">Horus</span><span class="ruby-operator">::</span><span class="ruby-constant">Application</span>.<span class="ruby-identifier">routes</span>
10:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="context-for-cramp-app-method" class="method-detail ">
				<a name="method-i-context_for_cramp_app"></a>

				<div class="method-heading">
				
					<span class="method-name">context_for_cramp_app</span><span
						class="method-args">(&example_group_block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Context for a cramp application or action; provides support for async get,
post etc.
</p>
					

					
					<div class="method-source-code"
						id="context-for-cramp-app-source">
<pre>
     <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 6</span>
  6: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">context_for_cramp_app</span>(&amp;<span class="ruby-identifier">example_group_block</span>)
  7:   
  8:   <span class="ruby-identifier">example_group_class</span> = <span class="ruby-identifier">context</span>(<span class="ruby-value str">&quot;cramp app&quot;</span>) <span class="ruby-keyword kw">do</span>
  9: 
 10:     <span class="ruby-identifier">before</span>(<span class="ruby-value">:all</span>) <span class="ruby-keyword kw">do</span> 
 11:       <span class="ruby-ivar">@request</span> = <span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">MockRequest</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">app</span>)
 12:     <span class="ruby-keyword kw">end</span>
 13:     
 14:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">path</span>, &amp;<span class="ruby-identifier">callback</span>)
 15:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
 16:         <span class="ruby-keyword kw">begin</span>
 17:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>)
 18:         <span class="ruby-keyword kw">rescue</span> 
 19:           <span class="ruby-identifier">stop</span>
 20:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
 21:         <span class="ruby-keyword kw">end</span>
 22:       <span class="ruby-keyword kw">end</span>
 23:       <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'async.callback'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">wrapped_callback</span>)
 24: 
 25:       <span class="ruby-constant">EM</span>.<span class="ruby-identifier">run</span> <span class="ruby-keyword kw">do</span>
 26:         <span class="ruby-identifier">catch</span>(<span class="ruby-value">:async</span>) <span class="ruby-keyword kw">do</span>
 27:           <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">headers</span>)
 28:           <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>([<span class="ruby-identifier">result</span>.<span class="ruby-identifier">status</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">header</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">body</span>])
 29:         <span class="ruby-keyword kw">end</span>
 30:       <span class="ruby-keyword kw">end</span>
 31:     <span class="ruby-keyword kw">end</span>
 32: 
 33:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_body</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
 34:       <span class="ruby-identifier">method</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:method</span>) <span class="ruby-operator">||</span> <span class="ruby-value">:get</span>
 35:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Only :get and :post are supported methods&quot;</span> <span class="ruby-keyword kw">unless</span> [<span class="ruby-value">:get</span>, <span class="ruby-value">:post</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
 36:       <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
 37:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
 38:         <span class="ruby-keyword kw">begin</span>
 39:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span>
 40:         <span class="ruby-keyword kw">rescue</span> 
 41:           <span class="ruby-identifier">stop</span>
 42:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
 43:         <span class="ruby-keyword kw">end</span>
 44:       <span class="ruby-keyword kw">end</span>
 45:       <span class="ruby-identifier">response_callback</span> = <span class="ruby-identifier">proc</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">response</span><span class="ruby-operator">|</span> <span class="ruby-identifier">response</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">chunk</span><span class="ruby-operator">|</span> <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">chunk</span>) } }
 46:       <span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">headers</span>, &amp;<span class="ruby-identifier">response_callback</span>)
 47:     <span class="ruby-keyword kw">end</span>
 48: 
 49:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_body_chunks</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
 50:       <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
 51:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
 52:         <span class="ruby-keyword kw">begin</span>
 53:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span>
 54:         <span class="ruby-keyword kw">rescue</span> 
 55:           <span class="ruby-identifier">stop</span>
 56:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
 57:         <span class="ruby-keyword kw">end</span>
 58:       <span class="ruby-keyword kw">end</span>
 59:       <span class="ruby-identifier">count</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:count</span>) <span class="ruby-operator">||</span> <span class="ruby-value">1</span>
 60: 
 61:       <span class="ruby-identifier">stopping</span> = <span class="ruby-keyword kw">false</span>
 62:       <span class="ruby-identifier">chunks</span> = []
 63: 
 64:       <span class="ruby-identifier">get_body</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">headers</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">body_chunk</span><span class="ruby-operator">|</span>
 65:         <span class="ruby-comment cmt"># pp body_chunk</span>
 66:         <span class="ruby-identifier">chunks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">body_chunk</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">stopping</span>
 67: 
 68:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">chunks</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">count</span>
 69:           <span class="ruby-identifier">stopping</span> = <span class="ruby-keyword kw">true</span>
 70:           <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">chunks</span>)
 71:           <span class="ruby-constant">EM</span>.<span class="ruby-identifier">next_tick</span> { <span class="ruby-constant">EM</span>.<span class="ruby-identifier">stop</span> }
 72:         <span class="ruby-keyword kw">end</span>
 73:       <span class="ruby-keyword kw">end</span>
 74:     <span class="ruby-keyword kw">end</span>
 75:     
 76:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
 77:       <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
 78:       <span class="ruby-identifier">timeout_secs</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:timeout</span>) <span class="ruby-operator">||</span> <span class="ruby-value">5</span>
 79:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
 80:         <span class="ruby-keyword kw">begin</span>
 81:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span>
 82:             <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>) 
 83:           <span class="ruby-keyword kw">else</span>
 84:             <span class="ruby-identifier">r</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">each</span> { <span class="ruby-identifier">stop</span> } <span class="ruby-comment cmt"># For some reason w/o reading the body, post methods fail.</span>
 85:           <span class="ruby-keyword kw">end</span>
 86:         <span class="ruby-keyword kw">rescue</span> 
 87:           <span class="ruby-identifier">stop</span>
 88:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
 89:         <span class="ruby-keyword kw">end</span>
 90:       <span class="ruby-keyword kw">end</span>      
 91:       <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'async.callback'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">wrapped_callback</span>)
 92:       
 93:       <span class="ruby-identifier">timeout</span>(<span class="ruby-identifier">timeout_secs</span>) <span class="ruby-keyword kw">do</span>
 94:         <span class="ruby-constant">EM</span>.<span class="ruby-identifier">run</span> <span class="ruby-keyword kw">do</span>
 95:           <span class="ruby-identifier">catch</span>(<span class="ruby-value">:async</span>) <span class="ruby-keyword kw">do</span> 
 96:             <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">headers</span>) 
 97:             <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>([<span class="ruby-identifier">result</span>.<span class="ruby-identifier">status</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">header</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">body</span>])
 98:           <span class="ruby-keyword kw">end</span>
 99:         <span class="ruby-keyword kw">end</span>
100:       <span class="ruby-keyword kw">end</span>
101:     <span class="ruby-keyword kw">end</span>
102:     
103:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop</span>
104:       <span class="ruby-constant">EM</span>.<span class="ruby-identifier">stop</span>
105:     <span class="ruby-keyword kw">end</span>
106:   <span class="ruby-keyword kw">end</span>
107:   
108:   <span class="ruby-identifier">example_group_class</span>.<span class="ruby-identifier">class_eval</span> &amp;<span class="ruby-identifier">example_group_block</span>
109: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="for-at-most-method" class="method-detail ">
				<a name="method-i-for_at_most"></a>

				<div class="method-heading">
				
					<span class="method-name">for_at_most</span><span
						class="method-args">(secs, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
class ForAtMostRunner
</p>
<pre>
  def initialize(secs)
    @secs = secs
  end
  
  def second
    seconds
  end
  
  def seconds(&amp;block)
    RSpec::Matchers.define :for_at_most do |actual|
      match do |actual|
        begin
          timeout(@secs) { actual.call }
          puts &quot;true&quot;
          true
        rescue Timeout::Error
          puts &quot;false&quot;
          false
        end
      end
      failure_message_for_should do |actual|
        &quot;expected to run for at most #{@secs}s&quot;
      end
    end
  end
</pre>
<p>
end
</p>
<p>
def <a href="Object.html#method-i-for_at_most">for_at_most</a>(secs = 0.01)
</p>
<pre>
  ForAtMostRunner.new(secs)
</pre>
<p>
end
</p>
					

					
					<div class="method-source-code"
						id="for-at-most-source">
<pre>
    <span class="ruby-comment cmt"># File spec/spec_helper.rb, line 37</span>
37: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">for_at_most</span>(<span class="ruby-identifier">secs</span>, &amp;<span class="ruby-identifier">block</span>)
38:   
39:   <span class="ruby-comment cmt"># RSpec::Matchers.define :for_at_most_matcher do |expected|</span>
40:   <span class="ruby-comment cmt">#   match do |actual|</span>
41:   <span class="ruby-comment cmt">#     p expected</span>
42:   <span class="ruby-comment cmt">#     p block</span>
43:   <span class="ruby-comment cmt">#     # begin</span>
44:   <span class="ruby-comment cmt">#     #   timeout(@secs) { actual.call }</span>
45:   <span class="ruby-comment cmt">#     #   puts &quot;true&quot;</span>
46:   <span class="ruby-comment cmt">#     #   true</span>
47:   <span class="ruby-comment cmt">#     # rescue Timeout::Error</span>
48:   <span class="ruby-comment cmt">#     #   puts &quot;false&quot;</span>
49:   <span class="ruby-comment cmt">#     #   false</span>
50:   <span class="ruby-comment cmt">#     # end</span>
51:   <span class="ruby-comment cmt">#   end</span>
52:   <span class="ruby-comment cmt">#   failure_message_for_should do |actual|</span>
53:   <span class="ruby-comment cmt">#     &quot;expected to run for at most #{secs}s&quot;</span>
54:   <span class="ruby-comment cmt">#   end</span>
55:   <span class="ruby-comment cmt"># end</span>
56:   <span class="ruby-comment cmt"># should for_at_most_matcher(secs, &amp;block)</span>
57: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-method" class="method-detail ">
				<a name="method-i-get"></a>

				<div class="method-heading">
				
					<span class="method-name">get</span><span
						class="method-args">(path, &callback)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="get-source">
<pre>
    <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 14</span>
14:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">path</span>, &amp;<span class="ruby-identifier">callback</span>)
15:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
16:         <span class="ruby-keyword kw">begin</span>
17:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>)
18:         <span class="ruby-keyword kw">rescue</span> 
19:           <span class="ruby-identifier">stop</span>
20:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
21:         <span class="ruby-keyword kw">end</span>
22:       <span class="ruby-keyword kw">end</span>
23:       <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'async.callback'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">wrapped_callback</span>)
24: 
25:       <span class="ruby-constant">EM</span>.<span class="ruby-identifier">run</span> <span class="ruby-keyword kw">do</span>
26:         <span class="ruby-identifier">catch</span>(<span class="ruby-value">:async</span>) <span class="ruby-keyword kw">do</span>
27:           <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">headers</span>)
28:           <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>([<span class="ruby-identifier">result</span>.<span class="ruby-identifier">status</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">header</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">body</span>])
29:         <span class="ruby-keyword kw">end</span>
30:       <span class="ruby-keyword kw">end</span>
31:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-method" class="method-detail ">
				<a name="method-i-get"></a>

				<div class="method-heading">
				
					<span class="method-name">get</span><span
						class="method-args">(path, options = {}, headers = {}, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
@request = Rack::MockRequest.new(HelloWorld.new)
</p>
					

					
					<div class="method-source-code"
						id="get-source">
<pre>
    <span class="ruby-comment cmt"># File test.rb, line 64</span>
64: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
65:   <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
66:   <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'async.callback'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">callback</span>)
67: 
68:   <span class="ruby-constant">EM</span>.<span class="ruby-identifier">run</span> <span class="ruby-keyword kw">do</span>
69:     <span class="ruby-identifier">catch</span>(<span class="ruby-value">:async</span>) { 
70:       <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">headers</span>) 
71:       <span class="ruby-comment cmt"># We're here because the app is not async or this is a response from</span>
72:       <span class="ruby-comment cmt"># HttpRouter which is sync.</span>
73:       <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>([<span class="ruby-identifier">result</span>.<span class="ruby-identifier">status</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">header</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">body</span>])
74:     }
75:   <span class="ruby-keyword kw">end</span>
76: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-body-method" class="method-detail ">
				<a name="method-i-get_body"></a>

				<div class="method-heading">
				
					<span class="method-name">get_body</span><span
						class="method-args">(path, options = {}, headers = {}, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="get-body-source">
<pre>
    <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 33</span>
33:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_body</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
34:       <span class="ruby-identifier">method</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:method</span>) <span class="ruby-operator">||</span> <span class="ruby-value">:get</span>
35:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Only :get and :post are supported methods&quot;</span> <span class="ruby-keyword kw">unless</span> [<span class="ruby-value">:get</span>, <span class="ruby-value">:post</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
36:       <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
37:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
38:         <span class="ruby-keyword kw">begin</span>
39:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span>
40:         <span class="ruby-keyword kw">rescue</span> 
41:           <span class="ruby-identifier">stop</span>
42:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
43:         <span class="ruby-keyword kw">end</span>
44:       <span class="ruby-keyword kw">end</span>
45:       <span class="ruby-identifier">response_callback</span> = <span class="ruby-identifier">proc</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">response</span><span class="ruby-operator">|</span> <span class="ruby-identifier">response</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">chunk</span><span class="ruby-operator">|</span> <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">chunk</span>) } }
46:       <span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">headers</span>, &amp;<span class="ruby-identifier">response_callback</span>)
47:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="get-body-chunks-method" class="method-detail ">
				<a name="method-i-get_body_chunks"></a>

				<div class="method-heading">
				
					<span class="method-name">get_body_chunks</span><span
						class="method-args">(path, options = {}, headers = {}, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="get-body-chunks-source">
<pre>
    <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 49</span>
49:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_body_chunks</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
50:       <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
51:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
52:         <span class="ruby-keyword kw">begin</span>
53:           <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span>
54:         <span class="ruby-keyword kw">rescue</span> 
55:           <span class="ruby-identifier">stop</span>
56:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
57:         <span class="ruby-keyword kw">end</span>
58:       <span class="ruby-keyword kw">end</span>
59:       <span class="ruby-identifier">count</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:count</span>) <span class="ruby-operator">||</span> <span class="ruby-value">1</span>
60: 
61:       <span class="ruby-identifier">stopping</span> = <span class="ruby-keyword kw">false</span>
62:       <span class="ruby-identifier">chunks</span> = []
63: 
64:       <span class="ruby-identifier">get_body</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">headers</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">body_chunk</span><span class="ruby-operator">|</span>
65:         <span class="ruby-comment cmt"># pp body_chunk</span>
66:         <span class="ruby-identifier">chunks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">body_chunk</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">stopping</span>
67: 
68:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">chunks</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">count</span>
69:           <span class="ruby-identifier">stopping</span> = <span class="ruby-keyword kw">true</span>
70:           <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">chunks</span>)
71:           <span class="ruby-constant">EM</span>.<span class="ruby-identifier">next_tick</span> { <span class="ruby-constant">EM</span>.<span class="ruby-identifier">stop</span> }
72:         <span class="ruby-keyword kw">end</span>
73:       <span class="ruby-keyword kw">end</span>
74:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="match-chunk-method" class="method-detail ">
				<a name="method-i-match_chunk"></a>

				<div class="method-heading">
				
					<span class="method-name">match_chunk</span><span
						class="method-args">(actual, expected)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="match-chunk-source">
<pre>
     <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 152</span>
152:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_chunk</span>(<span class="ruby-identifier">actual</span>, <span class="ruby-identifier">expected</span>)
153:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">actual</span>.<span class="ruby-identifier">nil?</span>
154:       <span class="ruby-keyword kw">false</span>
155:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Regexp</span>
156:       <span class="ruby-identifier">actual</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">expected</span>)
157:     <span class="ruby-keyword kw">else</span>
158:       <span class="ruby-identifier">actual</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">expected</span>
159:     <span class="ruby-keyword kw">end</span>
160:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="match-data-method" class="method-detail ">
				<a name="method-i-match_data"></a>

				<div class="method-heading">
				
					<span class="method-name">match_data</span><span
						class="method-args">(actual, expected)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="match-data-source">
<pre>
     <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 191</span>
191:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_data</span>(<span class="ruby-identifier">actual</span>, <span class="ruby-identifier">expected</span>)
192:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">actual</span>.<span class="ruby-identifier">nil?</span>
193:       <span class="ruby-keyword kw">false</span>
194:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">expected</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Regexp</span>
195:       <span class="ruby-identifier">actual</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">expected</span>)
196:     <span class="ruby-keyword kw">else</span>
197:       <span class="ruby-identifier">actual</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">expected</span>
198:     <span class="ruby-keyword kw">end</span>
199:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="parse-response-method" class="method-detail ">
				<a name="method-i-parse_response"></a>

				<div class="method-heading">
				
					<span class="method-name">parse_response</span><span
						class="method-args">(chunk)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="parse-response-source">
<pre>
     <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 201</span>
201:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_response</span>(<span class="ruby-identifier">chunk</span>)
202:     <span class="ruby-identifier">data</span> = (<span class="ruby-identifier">chunk</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^data: (.*)$/</span>).<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">$1</span>
203:     <span class="ruby-identifier">event_id</span> = (<span class="ruby-identifier">chunk</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^id: (.*)$/</span>).<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">$1</span>
204:     [<span class="ruby-identifier">data</span>, <span class="ruby-identifier">event_id</span>]
205:   <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="post-method" class="method-detail ">
				<a name="method-i-post"></a>

				<div class="method-heading">
				
					<span class="method-name">post</span><span
						class="method-args">(path, options = {}, headers = {}, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="post-source">
<pre>
     <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 76</span>
 76:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
 77:       <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
 78:       <span class="ruby-identifier">timeout_secs</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:timeout</span>) <span class="ruby-operator">||</span> <span class="ruby-value">5</span>
 79:       <span class="ruby-identifier">wrapped_callback</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
 80:         <span class="ruby-keyword kw">begin</span>
 81:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">callback</span>
 82:             <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>) 
 83:           <span class="ruby-keyword kw">else</span>
 84:             <span class="ruby-identifier">r</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">each</span> { <span class="ruby-identifier">stop</span> } <span class="ruby-comment cmt"># For some reason w/o reading the body, post methods fail.</span>
 85:           <span class="ruby-keyword kw">end</span>
 86:         <span class="ruby-keyword kw">rescue</span> 
 87:           <span class="ruby-identifier">stop</span>
 88:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">$!</span>
 89:         <span class="ruby-keyword kw">end</span>
 90:       <span class="ruby-keyword kw">end</span>      
 91:       <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'async.callback'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">wrapped_callback</span>)
 92:       
 93:       <span class="ruby-identifier">timeout</span>(<span class="ruby-identifier">timeout_secs</span>) <span class="ruby-keyword kw">do</span>
 94:         <span class="ruby-constant">EM</span>.<span class="ruby-identifier">run</span> <span class="ruby-keyword kw">do</span>
 95:           <span class="ruby-identifier">catch</span>(<span class="ruby-value">:async</span>) <span class="ruby-keyword kw">do</span> 
 96:             <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">headers</span>) 
 97:             <span class="ruby-identifier">wrapped_callback</span>.<span class="ruby-identifier">call</span>([<span class="ruby-identifier">result</span>.<span class="ruby-identifier">status</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">header</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">body</span>])
 98:           <span class="ruby-keyword kw">end</span>
 99:         <span class="ruby-keyword kw">end</span>
100:       <span class="ruby-keyword kw">end</span>
101:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="post-method" class="method-detail ">
				<a name="method-i-post"></a>

				<div class="method-heading">
				
					<span class="method-name">post</span><span
						class="method-args">(path, options = {}, headers = {}, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="post-source">
<pre>
    <span class="ruby-comment cmt"># File test.rb, line 78</span>
78: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">headers</span> = {}, &amp;<span class="ruby-identifier">block</span>)
79:   <span class="ruby-identifier">callback</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:callback</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>
80:   <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'async.callback'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">callback</span>)
81: 
82:   <span class="ruby-constant">EM</span>.<span class="ruby-identifier">run</span> <span class="ruby-keyword kw">do</span>
83:     <span class="ruby-identifier">catch</span>(<span class="ruby-value">:async</span>) <span class="ruby-keyword kw">do</span> 
84:       <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@request</span>.<span class="ruby-identifier">post</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">headers</span>) 
85:       <span class="ruby-identifier">callback</span>.<span class="ruby-identifier">call</span>([<span class="ruby-identifier">result</span>.<span class="ruby-identifier">status</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">header</span>, <span class="ruby-identifier">result</span>.<span class="ruby-identifier">body</span>])
86:     <span class="ruby-keyword kw">end</span>
87:   <span class="ruby-keyword kw">end</span>
88: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="start-thin-method" class="method-detail ">
				<a name="method-i-start_thin"></a>

				<div class="method-heading">
				
					<span class="method-name">start_thin</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
TODO Start thin in a separate thread? 
</p>
<p>
Currently it triggers &#8220;Illegal instruction&#8220;
</p>
<p>
def <a href="Object.html#method-i-start_thin">start_thin</a>
</p>
<pre>
  @server_thread = Thread.new do
    begin
      # Dir.chdir(File.join(File.dirname(__FILE__), &quot;../../&quot;))
      options = {:server =&gt; 'thin', :Port =&gt; 3000, :config =&gt; 'config.ru'}
      Rack::Server.start(options)
    rescue =&gt; e
      puts &quot;Error in server thread: #{e}\n#{e.backtrace.join(&quot;\n&quot;)}&quot;
      throw
    end
  end
  @server_thread.run

  sleep(2) # TODO Ugly: simply sleep for some time.
</pre>
<p>
end
</p>
<p>
def <a href="Object.html#method-i-stop_thin">stop_thin</a>
</p>
<pre>
  @server_thread.kill if @server_thread
</pre>
<p>
end
</p>
					

					
					<div class="method-source-code"
						id="start-thin-source">
<pre>
    <span class="ruby-comment cmt"># File features/support/thin_support.rb, line 26</span>
26: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">start_thin</span>
27:   <span class="ruby-identifier">_in_root_dir</span> <span class="ruby-keyword kw">do</span>
28:     <span class="ruby-value">`bundle exec thin -s1 -d start`</span>
29:   <span class="ruby-keyword kw">end</span>
30: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-method" class="method-detail ">
				<a name="method-i-stop"></a>

				<div class="method-heading">
				
					<span class="method-name">stop</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="stop-source">
<pre>
     <span class="ruby-comment cmt"># File spec/actions/actions_helper.rb, line 103</span>
103:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop</span>
104:       <span class="ruby-constant">EM</span>.<span class="ruby-identifier">stop</span>
105:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="stop-thin-method" class="method-detail ">
				<a name="method-i-stop_thin"></a>

				<div class="method-heading">
				
					<span class="method-name">stop_thin</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="stop-thin-source">
<pre>
    <span class="ruby-comment cmt"># File features/support/thin_support.rb, line 32</span>
32: <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stop_thin</span>
33:   <span class="ruby-identifier">_in_root_dir</span> <span class="ruby-keyword kw">do</span>
34:     <span class="ruby-value">`bundle exec thin -s1 stop`</span>
35:   <span class="ruby-keyword kw">end</span>
36: <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

